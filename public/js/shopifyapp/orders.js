(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{442:function(t,e,r){var n=r(531);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(4)(n,a);n.locals&&(t.exports=n.locals)},530:function(t,e,r){"use strict";r(442)},531:function(t,e,r){(t.exports=r(3)(!1)).push([t.i,".el-input--prefix .el-input__inner{border-radius:50px!important}.v-toolbar__content,.v-toolbar__extension{height:auto!important}.v-avatar{height:10px!important;width:10px!important;margin-left:40%!important}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper){cursor:pointer!important}#orders td{padding:0 0 0 15px!important}#orders .v-data-table>.v-data-table__wrapper>table{width:150%!important}#address_tab span{font-style:inherit;font-weight:inherit;white-space:nowrap;text-overflow:ellipsis;max-width:180px;overflow:hidden;display:block;-webkit-line-clamp:3;-webkit-box-orient:vertical}",""])},872:function(t,e,r){"use strict";r.r(e);var n=r(427),a=r(262),s=r(428),o=r(429),i=r(2);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function d(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u={props:["user","tenant"],components:{myShow:n.a,myStatus:a.a,myFilter:s.a,mySetup:o.a},inject:["theme"],data:function(){return{singleSelect:!1,selected:[],order_item:{search:""},filter_form:{app_custom_id:null},form:{},ready:!1,deleted_orders:!1,search:"",checkedRows:[],columns:[{label:"Created On",field:"created_at"},{label:"Client Name",field:"client_name"},{label:"Created By",field:"user_name"},{label:"Sub total",field:"sub_total"},{label:"Discount",field:"discount"},{label:"Total",field:"total_price"},{label:"Charges",field:"shipping_charges"},{label:"Printed",field:"printed"},{label:"Actions",field:"actions",sortable:!1}],snack:!1,setup_loaded:!1,default_filter:!0}},filters:{columnHead:function(t){return t.split("_").join(" ").toUpperCase()}},methods:{update_data:function(t){var e={data:t,model:"order_update",id:t.id};this.$store.dispatch("patchItems",e).then((function(t){}))},cancel:function(){},open_dialog:function(){},close:function(){console.log("Dialog closed")},open:function(t,e){var r=this;this.$prompt("Please enter reason for re-printing",{confirmButtonText:"OK",cancelButtonText:"Cancel"}).then((function(n){var a=n.value;r.print_change(t,e,a)})).catch((function(){}))},print_change:function(t,e,r){var n=this,a={model:"/print_change",id:e,data:{printed:t,comment:r}};this.$store.dispatch("patchItems",a).then((function(t){n.refreshSales()}))},search_order:function(){this.default_filter=!1;var t={model:"order_search",update:"updateSaleList",search:this.order_item.search};this.$store.dispatch("searchItems",t)},printOrder:function(){},openOrder:function(t){console.log(t);var e=t.id;this.$router.push({name:"saleorder",params:{id:e}}),this.getWarehouses()},openShow:function(t){eventBus.$emit("openShowSale",t)},googleUpload:function(){eventBus.$emit("GoogleUploadEvent")},updateStatus:function(t){eventBus.$emit("orderStatusEvent",t)},assign:function(t,e){eventBus.$emit(e,t)},openEdit:function(t){var e=t.id;this.$router.push({name:"editOrder",params:{id:e}}),this.getWarehouses()},get_orders:function(t){var e=this;if(console.log(t),t){var r={model:"/app_custom",id:t,update:"updateSaleList"};this.$store.dispatch("showItem",r).then((function(t){e.columns=t.data.columns}))}else this.getSales()},confirm_delete:function(t){var e=this;this.$confirm("This will permanently delete the file. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){e.deleteItem(t)})).catch((function(){e.$message({type:"error",message:"Delete canceled"})}))},restore_order:function(t){var e=this;this.$confirm("This will restore this order. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){e.restoreItem(t)})).catch((function(){e.$message({type:"error",message:"Restore canceled"})}))},restoreItem:function(t){var e=this,r={model:"sales_restore",data:{},id:t.id};this.$store.dispatch("patchItems",r).then((function(t){e.deletedOrders()}))},customView:function(){eventBus.$emit("openCustomViewEvent")},uploadOrder:function(t){eventBus.$emit("openOrderUploadEvent",t.row)},createOrder:function(t){this.$router.push({name:"create_order"})},deleteItem:function(t){var e=this;this.$store.dispatch("deleteItem","sales/"+t.id).then((function(t){e.$message({type:"success",message:"Delete completed"}),e.get_orders()}))},deleteItems:function(){var t=this;this.$confirm("This will delete the Order. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){t.get_orders();var e={model:"/sales_delete",data:t.selected};t.$store.dispatch("postItems",e).then((function(e){t.get_orders()}))})).catch((function(){t.$message({type:"error",message:"Delete canceled"})}))},getSales:function(){var t=this,e={model:"sale_filter",update:"updateSaleList",data:this.form};this.$store.dispatch("filterItems",e).then((function(e){t.deleted_orders=!1,t.ready=!0}))},refreshSales:function(){if(this.default_filter){this.deleted_orders=!1;var t={path:this.sales.sales.path,page:this.sales.sales.current_page};console.log(t),eventBus.$emit("refreshEvent",t)}else this.default_filter=!0,eventBus.$emit("filterItemsEvent")},deletedOrders:function(){var t=this;this.$store.dispatch("getItems",{model:"deleted_sales",update:"updateSaleList"}).then((function(e){t.deleted_orders=!0,t.ready=!0}))},get_filter:function(t){var e=this,r={model:"/columns",id:this.user.id,update:"updateFilterList"};this.$store.dispatch("showItem",r).then((function(t){e.deleted_orders=!1,e.form.app_custom_id=t.data.id,e.filter_form.app_custom_id=t.data.id,t.data>0&&e.get_orders(t.data.id)}))},getWarehouses:function(){this.$store.dispatch("getItems",{model:"/warehouses",update:"updateWarehouseList"})},getCustom:function(){this.$store.dispatch("getItems",{model:"/app_custom",update:"updateAppCustomList"})},next_page:function(t,e){var r={path:t,page:e};eventBus.$emit("refreshNextEvent",r)},getSetup:function(){var t=this;this.$store.dispatch("getItems",{model:"/setup",update:"updateSetup"}).then((function(e){t.setup_loaded=!0}))}},computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Object(i.b)(["app_custom","sales","loading","custom_sale","setup"])),mounted:function(){eventBus.$emit("LoadingEvent"),this.getSales(),this.getCustom(),this.getSetup()},created:function(){var t=this;this.getCustom(),this.get_filter(),eventBus.$on("saleEvent",(function(e){t.refreshSales()})),eventBus.$on("statusChangeEvent",(function(e){for(var r=0;r<t.sales.sales.data.length;r++){var n=t.sales.sales.data[r];if(n.id==e.id)var a=n}var s={data:e,index:t.sales.sales.data.indexOf(a)};t.$store.dispatch("updateStatus",s)})),eventBus.$on("responseChooseEvent",(function(t){console.log(t),"Excel"==t?eventBus.$emit("openEditSale"):eventBus.$emit("openCreateSale")}))}},p=(r(530),r(0)),v=Object(p.a)(u,(function(){var t=this,e=t._self._c;return e("div",[e("v-container",{attrs:{fluid:"","fill-height":"",id:"orders"}},[t.ready?e("v-card",{staticStyle:{padding:"20px 20px"},attrs:{width:"100%"}},[!t.setup_loaded||t.setup.products&&t.setup.vendors?e("v-layout",{attrs:{"justify-center":"","align-center":"",wrap:""}},[e("v-flex",{attrs:{sm12:""}},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("Dashboard")]),t._v(" "),e("el-breadcrumb-item",[t._v("Sales")])],1)],1),t._v(" "),e("v-divider"),t._v(" "),e("v-flex",{attrs:{sm9:""}},[e("v-text-field",{attrs:{label:"Track waybill",required:"","prepend-icon":"mdi-magnify"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search_order.apply(null,arguments)}},model:{value:t.order_item.search,callback:function(e){t.$set(t.order_item,"search",e)},expression:"order_item.search"}})],1),t._v(" "),e("v-flex",{attrs:{sm2:"","offset-sm1":""}}),t._v(" "),e("myFilter",{attrs:{form:t.filter_form,user:t.user}}),t._v(" "),e("v-flex",{staticStyle:{"margin-top":"30px"},attrs:{sm12:""}},[t.sales.sales.last_page>1?e("v-pagination",{attrs:{length:t.sales.sales.last_page,"total-visible":"5",circle:""},on:{input:function(e){return t.next_page(t.sales.sales.path,t.sales.sales.current_page)}},model:{value:t.sales.sales.current_page,callback:function(e){t.$set(t.sales.sales,"current_page",e)},expression:"sales.sales.current_page"}}):t._e()],1),t._v(" "),e("v-flex",{attrs:{sm12:""}},[e("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Quick Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),e("v-data-table",{staticClass:"elevation-1",staticStyle:{"font-size":"10px !important"},attrs:{headers:t.sales.columns,items:t.sales.sales.data,search:t.search,"single-select":t.singleSelect,"item-key":"id","show-select":"",loading:t.loading},scopedSlots:t._u([{key:"top",fn:function(){return[e("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(r){var n=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:t.refreshSales},slot:"activator"},n),[e("v-icon",{attrs:{color:"blue darken-2",small:""}},[t._v("mdi-refresh")])],1)]}}],null,!1,3244470444)},[t._v(" "),e("span",[t._v("Refresh")])]),t._v(" "),e("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(r){var n=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:t.deletedOrders},slot:"activator"},n),[e("v-icon",{attrs:{color:"blue darken-2",small:""}},[t._v("mdi-delete-sweep-outline")])],1)]}}],null,!1,2220292649)},[t._v(" "),e("span",[t._v("Deleted Orders")])]),t._v(" "),t.selected.length>0&&t.user.can["Order delete"]&&!t.deleted_orders?e("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(r){var n=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:t.deleteItems},slot:"activator"},n),[e("v-icon",{attrs:{color:"red darken-2",small:""}},[t._v("mdi-delete")])],1)]}}],null,!1,656046575)},[t._v(" "),e("span",[t._v("Delete selected orders")])]):t._e()]},proxy:!0},{key:"item.created_at",fn:function(r){var n=r.item;return[e("el-tag",{attrs:{type:"warning"}},[t._v(t._s(n.created_at))])]}},{key:"item.delivery_date",fn:function(r){var n=r.item;return[e("el-tag",{attrs:{type:"info"}},[t._v(t._s(n.delivery_date))])]}},{key:"item.sub_total",fn:function(r){var n=r.item;return[e("el-tag",{attrs:{type:"info"}},[t._v(t._s(n.sub_total))])]}},{key:"item.total",fn:function(r){var n=r.item;return[e("el-tag",{attrs:{type:"error"}},[t._v(t._s(n.total))])]}},{key:"item.delivery_status",fn:function(r){var n=r.item;return["Delivered"==n.delivery_status?e("el-tag",{attrs:{type:"success"}},[t._v(t._s(n.delivery_status))]):"Dispatched"==n.delivery_status||"Scheduled"==n.delivery_status?e("el-tag",{attrs:{type:"info"}},[t._v(t._s(n.delivery_status))]):"Returned"==n.delivery_status||"Cancelled"==n.delivery_status?e("el-tag",{attrs:{type:"danger"}},[t._v(t._s(n.delivery_status))]):e("el-tag",{attrs:{type:"warning"}},[t._v(t._s(n.delivery_status))])]}},{key:"item.paid",fn:function(t){var r=t.item;return[e("el-tooltip",{attrs:{content:r.paid?"Paid":"Not paid",placement:"top"}},[e("v-avatar",{staticStyle:{cursor:"pointer"},attrs:{color:r.paid?"green":"red",small:""}})],1)]}},{key:"item.printed",fn:function(r){var n=r.item;return[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(r){var a=r.on;return[t.user.can["Order print edit"]?e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(e){return t.open(n.printed,n.id)}},slot:"activator"},a),[n.printed?e("v-icon",{attrs:{small:"",color:"green"}},[t._v("mdi-check-circle")]):e("v-icon",{attrs:{small:"",color:"grey darken-2"}},[t._v("mdi-check-circle")])],1):e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},slot:"activator"},a),[n.printed?e("v-icon",{attrs:{small:"",color:"green"}},[t._v("mdi-check-circle")]):e("v-icon",{attrs:{small:"",color:"grey darken-2"}},[t._v("mdi-check-circle")])],1)]}}],null,!0)},[t._v(" "),n.printed?e("span",[t._v("Mark order as not printed ")]):e("span",[t._v("Mark order as printed ")])])]}},{key:"item.mpesa_code",fn:function(r){var n=r.item;return[e("el-tag",[t._v(t._s(n.mpesa_code))])]}},t.user.can["Order view"]?{key:"item.actions",fn:function(r){var n=r.item;return[e("div",{staticStyle:{"min-width":"240px"}},[t.user.can["Order edit"]&&!t.deleted_orders?e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(r){var a=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(e){return t.openEdit(n)}},slot:"activator"},a),[e("v-icon",{attrs:{small:"",color:"blue darken-2"}},[t._v("mdi-pencil")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Edit order "+t._s(n.order_no))])]):t._e(),t._v(" "),t.user.can["Order update status"]&&!t.deleted_orders?e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(r){var a=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(e){return t.updateStatus(n)}},slot:"activator"},a),[e("v-icon",{attrs:{small:"",color:"blue darken-2"}},[t._v("mdi-upload-network-outline")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Update order "+t._s(n.order_no)+" Status")])]):t._e(),t._v(" "),e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([t.user.can["Order view details"]?{key:"activator",fn:function(r){var a=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(e){return t.openOrder(n)}},slot:"activator"},a),[e("v-icon",{attrs:{small:"",color:"blue darken-2"}},[t._v("mdi-eye")])],1)]}}:null],null,!0)},[t._v(" "),e("span",[t._v("Order "+t._s(n.order_no)+" details")])]),t._v(" "),!t.user.can["Order print edit"]||n.printed||t.deleted_orders?t._e():e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(r){var a=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:"",href:"/pack_download/"+n.id,target:"_blank"},slot:"activator"},a),[e("v-icon",{attrs:{small:"",color:"blue darken-2"}},[t._v("mdi-printer")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Print "+t._s(n.order_no))])]),t._v(" "),t.user.can["Order delete"]&&!t.deleted_orders?e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(r){var a=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(e){return t.confirm_delete(n)}},slot:"activator"},a),[e("v-icon",{attrs:{small:"",color:"pink darken-2"}},[t._v("mdi-delete")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Delete order "+t._s(n.order_no))])]):t._e(),t._v(" "),t.user.can["Order delete"]&&t.deleted_orders?e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(r){var a=r.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(e){return t.restore_order(n)}},slot:"activator"},a),[e("v-icon",{attrs:{small:"",color:"pink darken-2"}},[t._v("mdi-history")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Delete order "+t._s(n.order_no))])]):t._e()],1)]}}:null,t.user.can["Order edit"]?{key:"item.client_phone",fn:function(r){return[e("v-edit-dialog",{attrs:{"return-value":r.item.client_phone,large:"",persistent:""},on:{"update:returnValue":function(e){return t.$set(r.item,"client_phone",e)},"update:return-value":function(e){return t.$set(r.item,"client_phone",e)},save:function(e){return t.update_data(r.item)},cancel:t.cancel,open:t.open_dialog,close:t.close},scopedSlots:t._u([{key:"input",fn:function(){return[e("div",{staticClass:"mt-4 title",staticStyle:{color:"#333"}},[t._v("\n                                        Update phone\n                                    ")]),t._v(" "),e("v-text-field",{attrs:{label:"Edit","single-line":"",counter:"",autofocus:""},model:{value:r.item.client_phone,callback:function(e){t.$set(r.item,"client_phone",e)},expression:"props.item.client_phone"}})]},proxy:!0}],null,!0)},[e("div",[t._v(t._s(r.item.client_phone))])])]}}:null,t.user.can["Order edit"]?{key:"item.client_name",fn:function(r){return[e("v-edit-dialog",{attrs:{"return-value":r.item.client_name,large:"",persistent:""},on:{"update:returnValue":function(e){return t.$set(r.item,"client_name",e)},"update:return-value":function(e){return t.$set(r.item,"client_name",e)},save:function(e){return t.update_data(r.item)},cancel:t.cancel,open:t.open_dialog,close:t.close},scopedSlots:t._u([{key:"input",fn:function(){return[e("div",{staticClass:"mt-4 title",staticStyle:{color:"#333"}},[t._v("\n                                        Update name\n                                    ")]),t._v(" "),e("v-text-field",{attrs:{label:"Edit","single-line":"",counter:"",autofocus:""},model:{value:r.item.client_name,callback:function(e){t.$set(r.item,"client_name",e)},expression:"props.item.client_name"}})]},proxy:!0}],null,!0)},[e("div",[t._v(t._s(r.item.client_name))])])]}}:null,t.user.can["Order edit"]?{key:"item.client_address",fn:function(r){return[e("v-edit-dialog",{attrs:{"return-value":r.item.client_address,large:"",persistent:""},on:{"update:returnValue":function(e){return t.$set(r.item,"client_address",e)},"update:return-value":function(e){return t.$set(r.item,"client_address",e)},save:function(e){return t.update_data(r.item)},cancel:t.cancel,open:t.open_dialog,close:t.close},scopedSlots:t._u([{key:"input",fn:function(){return[e("div",{staticClass:"mt-4 title",staticStyle:{color:"#333"}},[t._v("\n                                        Update address\n                                    ")]),t._v(" "),e("v-text-field",{attrs:{label:"Edit","single-line":"",counter:"",autofocus:""},model:{value:r.item.client_address,callback:function(e){t.$set(r.item,"client_address",e)},expression:"props.item.client_address"}})]},proxy:!0}],null,!0)},[e("span",{attrs:{id:"address_tab"}},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.item.client_address,placement:"top-start"}},[e("span",[t._v("\n                                            "+t._s(r.item.client_address)+"\n                                        ")])])],1)])]}}:null],null,!0),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)],1):e("div",[e("mySetup")],1)],1):e("v-sheet",{staticClass:"px-3 pt-3 pb-3",staticStyle:{width:"100vw"},attrs:{color:"grey ".concat(t.theme.isDark?"darken-2":"lighten-4")}},[e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{"max-width":"900",type:"table"}})],1),t._v(" "),e("myShow"),t._v(" "),e("myStatus")],1)],1)}),[],!1,null,null,null);e.default=v.exports}}]);