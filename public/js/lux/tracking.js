(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{1146:function(e,t,a){"use strict";a.r(t);var r=a(262),o=a(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function n(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i={components:{myStatus:r.a},props:["user"],data:function(){return{form:{},loader:!1,search:"",checkedRows:[],tab:0,headers:[{text:"Created On",value:"created_at"},{text:"Order Number",align:"start",value:"order_no"},{text:"Product Name",value:"product_name"},{text:"Special instructions",value:"notes"},{text:"Client Name",value:"client.name"},{text:"Client Phone",value:"client.phone"},{text:"Client Address",value:"client.address"},{text:"Vendor Name",value:"seller.name"},{text:"Delivery status",value:"delivery_status"},{text:"status",value:"status"},{text:"Delivery Date",value:"delivery_date"},{text:"Actions",value:"actions"}]}},filters:{columnHead:function(e){return e.split("_").join(" ").toUpperCase()}},methods:{createOrder:function(e){this.$router.push({name:"create_order"})},updateStatus:function(e){eventBus.$emit("orderStatusEvent",e)},deleteItem:function(e){var t=this;this.$store.dispatch("deleteItem","sales/"+e.id).then((function(e){t.$message({type:"success",message:"Delete completed"}),t.getSales()}))},getSales:function(){if(0==this.tab)var e="tracking/Scheduled";else if(1==this.tab)e="tracking/Dispatched";else e="tracking/Pedding";var t={model:e,update:"updateSaleList"};this.$store.dispatch("getItems",t)},dashboardSales:function(e){var t={model:"tracking/"+e,update:"updateSaleList"};this.$store.dispatch("getItems",t)},getWarehouses:function(){this.$store.dispatch("getItems",{model:"/warehouses",update:"updateWarehouseList"})},getCustom:function(){this.$store.dispatch("getItems",{model:"/app_custom",update:"updateAppCustomList"})},next_page:function(e,t){var a={path:e,page:t,update:"updateSaleList"};this.$store.dispatch("nextPage",a)}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(o.b)(["app_custom","sales","loading","custom_sale"])),mounted:function(){console.log(this.$route.query.data),this.$route.query.data?this.dashboardSales(this.$route.query.data):(eventBus.$emit("LoadingEvent"),this.getSales()),this.getCustom()},created:function(){var e=this;eventBus.$on("saleEvent",(function(t){e.getSales()})),eventBus.$on("responseChooseEvent",(function(e){console.log(e),"Excel"==e?eventBus.$emit("openEditSale"):eventBus.$emit("openCreateSale")}))}},c=(a(830),a(0)),d=Object(c.a)(i,(function(){var e=this,t=e._self._c;return t("div",[t("v-container",{attrs:{fluid:"","fill-height":""}},[t("v-card",{staticStyle:{padding:"20px 0"}},[t("v-layout",{attrs:{"justify-center":"","align-center":"",wrap:""}},[t("v-flex",{attrs:{sm12:""}},[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("Dashboard")]),e._v(" "),t("el-breadcrumb-item",[e._v("Sales")])],1)],1),e._v(" "),t("v-flex",{attrs:{sm12:""}}),e._v(" "),t("v-flex",{attrs:{sm12:""}},[t("v-layout",{attrs:{row:""}},[t("v-flex",{attrs:{sm12:""}},[t("h3",{staticStyle:{"margin-left":"30px !important","margin-top":"10px"}},[e._v("\n                            "+e._s(this.$route.query.data)+"    Orders\n                            ")])])],1),e._v(" "),t("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(a){var r=a.on;return[t("v-btn",e._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:e.getSales},slot:"activator"},r),[t("v-icon",{attrs:{color:"blue darken-2",small:""}},[e._v("mdi-refresh")])],1)]}}])},[e._v(" "),t("span",[e._v("Refresh")])])],1),e._v(" "),t("v-flex",{attrs:{sm12:""}},[e.sales.last_page>1?t("v-pagination",{attrs:{length:e.sales.last_page,"total-visible":"5",circle:""},on:{input:function(t){return e.next_page(e.sales.path,e.sales.current_page)}},model:{value:e.sales.current_page,callback:function(t){e.$set(e.sales,"current_page",t)},expression:"sales.current_page"}}):e._e()],1),e._v(" "),e.$route.query.data?e._e():t("v-flex",{attrs:{sm12:""}},[t("v-tabs",{attrs:{"background-color":"indigo",dark:""},on:{change:e.getSales},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t("v-tab",[e._v(" Scheduled ")]),e._v(" "),t("v-tab",[e._v(" Dispatched ")]),e._v(" "),t("v-tab",[e._v(" Pedding ")])],1)],1),e._v(" "),t("v-flex",{attrs:{sm12:""}},[t("v-data-table",{attrs:{headers:e.headers,items:e.sales.data,search:e.search},scopedSlots:e._u([{key:"item.created_at",fn:function(a){var r=a.item;return[t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(r.created_at))])]}},{key:"item.delivery_date",fn:function(a){var r=a.item;return[t("el-tag",{attrs:{type:"info"}},[e._v(e._s(r.delivery_date))])]}},{key:"item.sub_total",fn:function(a){var r=a.item;return[t("el-tag",{attrs:{type:"info"}},[e._v(e._s(r.sub_total))])]}},{key:"item.total",fn:function(a){var r=a.item;return[t("el-tag",{attrs:{type:"error"}},[e._v(e._s(r.total))])]}},{key:"item.delivery_status",fn:function(a){var r=a.item;return[t("el-tag",[e._v(e._s(r.delivery_status))])]}},{key:"item.actions",fn:function(a){var r=a.item;return[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(a){var o=a.on;return[e.user.can["Order update status"]?t("v-btn",e._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(t){return e.updateStatus(r)}},slot:"activator"},o),[t("v-icon",{attrs:{small:"",color:"blue darken-2"}},[e._v("mdi-upload-network-outline")])],1):e._e()]}}],null,!0)},[e._v(" "),t("span",[e._v("Update order "+e._s(r.order_no)+" Status")])])]}}])})],1)],1)],1)],1),e._v(" "),t("myStatus")],1)}),[],!1,null,"646de3d0",null);t.default=d.exports},262:function(e,t,a){"use strict";var r=a(2);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function n(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i={name:"saleStatus",data:function(){return{pendingReason:["UNRESPONSIVE","UNREACHABLE","LINE BUSY","CLIENT IS IN A MEETING, WILL CALL US BACK LATER","CLIENT IS IN A MEETING, WANTS TO BE CALLED LATER","HANGED UP ON CALLS","CLIENT IS IN A NOISY PLACE","CLIENT IS SILENT ON CALLS","TO BE CALLED TOMORROW","TO BE CALLED NEXT WEEK (dates to be indicated)","WHATSAPP PHOTO SENT, AWAITING RESPONSE","MERCHANT INFORMED, AWAITING RESPONSE","OWNER OF THE PHONE IS NOT AROUND, WILL CALL US BACK"],cancelReason:["CLIENT CHANGED THEIR MIND","PRODUCT IS TOO EXPENSIVE","DID NOT PLACE THE ORDER","THE ORDER TOOK LONG","WILL CALL AND REORDER WHEN READY FINANCIALLY","WILL CALL AND REORDER WHEN BACK IN TOWN","GOT A CHEAPER ALTERNATIVE","WRONG NUMBER","INCOMPLETE NUMBER","NOT A KENYAN ORDER","WILL CALL AND REORDER WHEN READY TO PICK THE PARCEL","DOES NOT MEET THEIR EXPECTATIONS","WAS ONLY INQUIRING","WANTED A FURTHER DISCOUT","NEVER PICKS PARCELS"],pickerOptions:{disabledDate:function(e){return e.getTime()+864e5<Date.now()},shortcuts:[{text:"Today",onClick:function(e){e.$emit("pick",new Date)}},{text:"Tomorrow",onClick:function(e){var t=new Date;t.setTime(t.getTime()+864e5),e.$emit("pick",t)}}]},dialog:!1,form:{partial_delivery:"delivered",zone_from:null,zone_to:null},selectedZone:null,zone_data:{zone_from:null,zone_to:null},zoneSelectKey:0}},created:function(){var e=this;eventBus.$on("orderStatusEvent",(function(t){console.log("data"),console.log(t),console.log("data"),e.dialog=!0,t.payment_method=null==t.payment_method?"Cash":t.payment_method,e.form=t,e.selectedZone=e.form.zone_to,e.zones.length<1&&e.getZones(),e.statuses.length<1&&e.getStatus(),e.api_connect.length<1&&e.getApi()}))},watch:{"form.delivery_status":function(e,t){this.selectedZone=this.form.zone_to},"form.zone_to":function(e){this.selectedZone=e}},methods:{zoneToChanged:function(e){this.form.zone_to=e,console.log("Zone To Changed:",e),console.log("Form Zone To:",this.form.zone_to)},getStatus:function(){this.$store.dispatch("getItems",{model:"statuses",update:"updateStatusList"})},getZones:function(){this.$store.dispatch("getItems",{model:"zones",update:"updateZone"})},getOrderZones:function(e){var t=this,a={model:"sale_zones/"+e,update:"UpdateEmpty"};this.$store.dispatch("getItems",a).then((function(e){console.log(e.data.zone_id),t.form.zone_to=e.data.zone_to,t.form.zone_from=e.data.zone_id,console.log("this"),console.log(t.form)}))},updateStatus:function(){var e=this;!this.selectedZone||"Scheduled"!==this.form.delivery_status&&"Dispatched"!==this.form.delivery_status||(this.form.zone_to=this.selectedZone),console.log("Submitting form with zone_to:",this.form.zone_to);var t={model:"status_update",id:this.form.id,data:this.form};this.$store.dispatch("patchItems",t).then((function(t){e.close()}))},getApi:function(){this.$store.dispatch("getItems",{model:"api_check",update:"updatApiConnection"}).then((function(e){}))},close:function(){this.dialog=!1}},mounted:function(){},computed:l(l({},Object(r.b)(["statuses","zones","errors","loading","api_connect"])),{},{showZoneTo:function(){return"Dispatched"===this.form.delivery_status||"Scheduled"===this.form.delivery_status}})},c=a(0),d=Object(c.a)(i,(function(){var e=this,t=e._self._c;return t("v-layout",{attrs:{row:"","justify-center":""}},[t("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"headline",staticStyle:{margin:"auto"}},[e._v("Order Details")])]),e._v(" "),t("VDivider"),e._v(" "),t("v-card-text",[t("v-container",{attrs:{"grid-list-md":""}},[t("v-layout",{attrs:{wrap:""}},[t("v-flex",{attrs:{sm12:""}},[t("label",{staticClass:"col-md-5 col-lg-5"},[e._v("Status")]),e._v(" "),t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"Select"},model:{value:e.form.delivery_status,callback:function(t){e.$set(e.form,"delivery_status",t)},expression:"form.delivery_status"}},e._l(e.statuses,(function(e){return t("el-option",{key:e.id,attrs:{label:e.status,value:e.status}})})),1),e._v(" "),e.errors.delivery_status?t("small",{staticClass:"has-text-danger"},[e._v(e._s(e.errors.delivery_status[0]))]):e._e()],1),e._v(" "),"Scheduled"==e.form.delivery_status?t("v-flex",{attrs:{sm12:""}},[t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration",staticStyle:{float:"left"}},[e._v("Schedule Date")]),e._v(" "),t("el-date-picker",{staticStyle:{width:"100%"},attrs:{format:"yyyy/MM/dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,type:"date",placeholder:"Pick a day"},model:{value:e.form.delivery_date,callback:function(t){e.$set(e.form,"delivery_date",t)},expression:"form.delivery_date"}})],1),e._v(" "),e.errors.delivery_date?t("small",{staticClass:"has-text-danger"},[e._v(e._s(e.errors.delivery_date[0]))]):e._e()]):e._e(),e._v(" "),"Scheduled"!=e.form.delivery_status?t("v-flex",{attrs:{sm12:""}},[t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration",staticStyle:{float:"left"}},[e._v("Recall Date")]),e._v(" "),t("el-date-picker",{staticStyle:{width:"100%"},attrs:{format:"yyyy/MM/dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,type:"date",placeholder:"Pick a day"},model:{value:e.form.recall_date,callback:function(t){e.$set(e.form,"recall_date",t)},expression:"form.recall_date"}})],1),e._v(" "),e.errors.delivery_date?t("small",{staticClass:"has-text-danger"},[e._v(e._s(e.errors.delivery_date[0]))]):e._e()]):e._e(),e._v(" "),"Dispatched"==e.form.delivery_status?t("v-flex",{attrs:{sm12:""}},[t("label",{staticClass:"col-md-5 col-lg-5"},[e._v("Zone from")]),e._v(" "),t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"Select"},model:{value:e.form.zone_from,callback:function(t){e.$set(e.form,"zone_from",t)},expression:"form.zone_from"}},e._l(e.zones,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),e._v(" "),e.errors.zone_id?t("small",{staticClass:"has-text-danger"},[e._v(e._s(e.errors.zone_id[0]))]):e._e()],1):e._e(),e._v(" "),e.showZoneTo?t("v-flex",{attrs:{sm12:""}},[t("label",{staticClass:"col-md-5 col-lg-5"},[e._v("Zone to")]),e._v(" "),t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"Select"},on:{change:e.zoneToChanged},model:{value:e.selectedZone,callback:function(t){e.selectedZone=t},expression:"selectedZone"}},e._l(e.zones,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),e._v(" "),e.errors.zone_id?t("small",{staticClass:"has-text-danger"},[e._v(e._s(e.errors.zone_id[0]))]):e._e()],1):e._e(),e._v(" "),e.api_connect.mpesa&&"Delivered"==e.form.delivery_status?t("v-flex",{attrs:{sm6:""}},[t("el-radio",{attrs:{border:"",label:"Cash"},model:{value:e.form.payment_method,callback:function(t){e.$set(e.form,"payment_method",t)},expression:"form.payment_method"}},[e._v("Cash")]),e._v(" "),t("el-radio",{attrs:{border:"",label:"Mpesa"},model:{value:e.form.payment_method,callback:function(t){e.$set(e.form,"payment_method",t)},expression:"form.payment_method"}},[e._v("M-pesa")])],1):e._e(),e._v(" "),"Delivered"==e.form.delivery_status?t("v-flex",{attrs:{sm6:""}},[t("el-radio",{attrs:{label:"delivered"},model:{value:e.form.partial_delivery,callback:function(t){e.$set(e.form,"partial_delivery",t)},expression:"form.partial_delivery"}},[e._v("Delivered")]),e._v(" "),t("el-radio",{attrs:{label:"partial_delivery"},model:{value:e.form.partial_delivery,callback:function(t){e.$set(e.form,"partial_delivery",t)},expression:"form.partial_delivery"}},[e._v("Partial\n                                delivery")])],1):e._e(),e._v(" "),"Delivered"==e.form.delivery_status&&"partial_delivery"==e.form.partial_delivery?t("v-flex",{attrs:{sm12:""}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.products}},[t("el-table-column",{attrs:{prop:"product_name",label:"Date",width:"180"}}),e._v(" "),t("el-table-column",{attrs:{prop:"pivot.quantity_tobe_delivered",label:"Expected items",width:"180"}}),e._v(" "),t("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"Please input"},model:{value:a.row.pivot.quantity_delivered,callback:function(t){e.$set(a.row.pivot,"quantity_delivered",t)},expression:"scope.row.pivot.quantity_delivered"}})]}}],null,!1,3133951746)})],1)],1):e._e(),e._v(" "),"Delivered"==e.form.delivery_status&&"partial_delivery"==e.form.partial_delivery?t("v-flex",{attrs:{sm12:""}},[t("label",{staticClass:"col-md-5 col-lg-5"},[e._v("New Cod")]),e._v(" "),t("el-input",{attrs:{placeholder:"Please input"},model:{value:e.form.amount_paid,callback:function(t){e.$set(e.form,"amount_paid",t)},expression:"form.amount_paid"}})],1):e._e(),e._v(" "),e.api_connect.mpesa&&"Delivered"==e.form.delivery_status&&"Mpesa"==e.form.payment_method?t("v-flex",{attrs:{sm12:""}},[t("label",{staticClass:"col-md-5 col-lg-5"},[e._v("Mpesa Code")]),e._v(" "),t("el-input",{attrs:{placeholder:"PH9..."},model:{value:e.form.mpesa_code,callback:function(t){e.$set(e.form,"mpesa_code",t)},expression:"form.mpesa_code"}}),e._v(" "),e.errors.mpesa_code?t("small",{staticClass:"has-text-danger"},[e._v(e._s(e.errors.mpesa_code[0]))]):e._e()],1):e._e(),e._v(" "),"Pending"==e.form.delivery_status||"Cancelled"==e.form.delivery_status?t("v-flex",{attrs:{sm12:""}},[t("label",{staticStyle:{color:"#52627d"},attrs:{for:""}},[e._v("Comments")]),e._v(" "),"Pending"==e.form.delivery_status?t("el-select",{staticStyle:{width:"100%"},attrs:{"allow-create":"",filterable:"",clearable:"",placeholder:"Select"},model:{value:e.form.customer_notes,callback:function(t){e.$set(e.form,"customer_notes",t)},expression:"form.customer_notes"}},e._l(e.pendingReason,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):"Cancelled"==e.form.delivery_status?t("el-select",{staticStyle:{width:"100%"},attrs:{"allow-create":"",filterable:"",clearable:"",placeholder:"Select"},model:{value:e.form.customer_notes,callback:function(t){e.$set(e.form,"customer_notes",t)},expression:"form.customer_notes"}},e._l(e.cancelReason,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),e._v(" "),t("br")],1):e._e(),e._v(" "),t("v-flex",{attrs:{sm12:""}},[t("label",{staticStyle:{color:"#52627d"},attrs:{for:""}},[e._v("Comments")]),e._v(" "),t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"comments",maxlength:"500","show-word-limit":""},model:{value:e.form.customer_notes,callback:function(t){e.$set(e.form,"customer_notes",t)},expression:"form.customer_notes"}}),e._v(" "),e.errors.customer_notes?t("small",{staticClass:"has-text-danger"},[e._v(e._s(e.errors.customer_notes[0]))]):e._e()],1)],1)],1)],1),e._v(" "),t("v-card-actions",[t("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Close")]),e._v(" "),t("VSpacer"),e._v(" "),t("v-btn",{attrs:{color:"primary",loading:e.loading,disabled:e.loading},on:{click:e.updateStatus}},[e._v("Update")])],1)],1)],1)],1)}),[],!1,null,null,null);t.a=d.exports},644:function(e,t,a){var r=a(831);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};a(4)(r,o);r.locals&&(e.exports=r.locals)},830:function(e,t,a){"use strict";a(644)},831:function(e,t,a){(e.exports=a(3)(!1)).push([e.i,".el-input--prefix .el-input__inner[data-v-646de3d0]{border-radius:50px!important}.v-toolbar__content[data-v-646de3d0],.v-toolbar__extension[data-v-646de3d0]{height:auto!important}.v-avatar[data-v-646de3d0]{height:10px!important;width:10px!important;margin-left:40%!important}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr[data-v-646de3d0]:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper){cursor:pointer!important}",""])}}]);