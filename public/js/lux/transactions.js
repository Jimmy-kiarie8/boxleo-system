(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{1131:function(t,e,a){"use strict";a.r(e);var r=a(2),n={data:function(){return{dialog:!1,loading:!1,order:[],selectedItem:0}},created:function(){var t=this;eventBus.$on("mpesaTransaction",(function(e){t.dialog=!0,t.getOrder(e)}))},methods:{close:function(){this.dialog=!1},getOrder:function(t){var e=this;axios.get("transaction_order/"+t).then((function(t){e.order=t.data})).catch((function(t){console.error(t)}))}},computed:{}},o=a(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function l(t,e,a){return(e=function(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,e||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var c={props:["user","tenant"],components:{myShow:Object(o.a)(n,(function(){var t=this,e=t._self._c;return e("v-layout",{attrs:{row:"","justify-center":""}},[e("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t.dialog?e("v-card",[e("v-card-title",[e("span",{staticClass:"headline text-center",staticStyle:{margin:"auto"}},[t._v("Order Details")]),t._v(" "),e("VSpacer"),t._v(" "),e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var r=a.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:t.close},slot:"activator"},r),[e("v-icon",{attrs:{small:"",color:"blue darken-2"}},[t._v("close")])],1)]}}],null,!1,1092174889)},[t._v(" "),e("span",[t._v("close")])])],1),t._v(" "),e("v-divider"),t._v(" "),e("v-card-text",[e("v-container",{attrs:{"grid-list-md":""}},[e("v-layout",{attrs:{row:"",wrap:""}},[e("v-flex",{attrs:{sm12:""}},[e("v-list",{attrs:{dense:""}},[e("v-subheader",[t._v(t._s(t.order.order_no))]),t._v(" "),e("v-list-item-group",{attrs:{color:"primary"},model:{value:t.selectedItem,callback:function(e){t.selectedItem=e},expression:"selectedItem"}},[e("v-list-item",[e("v-list-item-icon",[e("v-icon",[t._v("mdi-cash-100")])],1),t._v(" "),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(t.order.total_price)}})],1)],1),t._v(" "),e("v-list-item",[e("v-list-item-icon",[e("v-icon",[t._v("mdi-update")])],1),t._v(" "),e("v-list-item-content",[e("v-list-item-title",{domProps:{textContent:t._s(t.order.delivery_status)}})],1)],1)],1)],1)],1),t._v(" "),e("v-flex",{attrs:{sm12:""}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.order.products}},[e("el-table-column",{attrs:{prop:"product_name",label:"Product Name",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{prop:"pivot.quantity",label:"Quantity",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{prop:"pivot.price",label:"Price"}})],1)],1),t._v(" "),e("br"),t._v(" "),e("br"),t._v(" "),e("h5",[t._v("Client")]),t._v(" "),e("v-divider"),t._v(" "),e("v-flex",{attrs:{sm12:""}},[e("table",{staticClass:"table table-striped table-condensed"},[e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Name")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Phone")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Address")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v(t._s(t.order.client.name))]),t._v(" "),e("td",[t._v(t._s(t.order.client.phone))]),t._v(" "),e("td",[t._v(t._s(t.order.client.address))])])])])])],1)],1)],1)],1):t._e()],1)],1)}),[],!1,null,null,null).exports},inject:["theme"],data:function(){return{search:"",form:{},trans_item:{search:""},ready:!1,headers:[{text:"Created On",value:"created_at"},{text:"Account No.",value:"BillRefNumber"},{text:"Transaction Id",value:"TransID"},{text:"Transaction time",value:"TransTime"},{text:"Amount",value:"TransAmount"},{text:"Phone number",value:"MSISDN"},{text:"Name",value:"name"},{text:"Code matched",value:"code_used"},{text:"Transaction Type",value:"TransactionType"},{text:"Actions",value:"actions",sortable:!1}],snack:!1,setup_loaded:!1,default_filter:!0}},methods:{filter:function(){var t=this,e={model:"transactions-filter",update:"updateTransactions",data:this.form};this.$store.dispatch("filterItems",e).then((function(){t.ready=!0}))},getTransactions:function(){var t=this;this.$store.dispatch("getItems",{model:"transactions",update:"updateTransactions"}).then((function(){t.ready=!0}))},search_trans:function(){var t={model:"transaction_search",update:"updateTransactions",search:this.trans_item.search};this.$store.dispatch("searchItems",t)},next_page:function(t,e){var a={path:t,page:e};eventBus.$emit("refreshNextEvent",a)},openShow:function(t){eventBus.$emit("mpesaTransaction",t)}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){l(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(r.b)(["transactions","loading"])),mounted:function(){this.getTransactions()}},d=(a(856),Object(o.a)(c,(function(){var t=this,e=t._self._c;return e("div",[e("v-container",{attrs:{fluid:"","fill-height":"",id:"orders"}},[t.ready?e("v-card",{staticStyle:{padding:"20px 20px"},attrs:{width:"100%"}},[!t.setup_loaded||t.setup.products&&t.setup.vendors?e("v-layout",{attrs:{"justify-center":"","align-center":"",wrap:""}},[e("v-flex",{attrs:{sm12:""}},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("Dashboard")]),t._v(" "),e("el-breadcrumb-item",[t._v("M-pesa")])],1)],1),t._v(" "),e("v-divider"),t._v(" "),e("v-flex",{attrs:{sm12:""}},[e("v-text-field",{attrs:{label:"Search transaction",required:"","prepend-icon":"mdi-magnify"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search_trans.apply(null,arguments)}},model:{value:t.trans_item.search,callback:function(e){t.$set(t.trans_item,"search",e)},expression:"trans_item.search"}})],1),t._v(" "),e("v-flex",{attrs:{sm12:""}},[e("el-date-picker",{staticStyle:{width:"50%"},attrs:{type:"daterange",align:"right","start-placeholder":"Start Date","end-placeholder":"End Date",format:"yyyy/MM/dd","value-format":"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}}),t._v(" "),e("v-btn-toggle",{staticStyle:{"margin-top":"22px"},attrs:{dense:"","background-color":"primary",dark:""}},[e("v-btn",{on:{click:t.filter}},[e("v-icon",[t._v("mdi-magnify")])],1)],1)],1),t._v(" "),e("v-flex",{staticStyle:{"margin-top":"30px"},attrs:{sm12:""}},[t.transactions.last_page>1?e("v-pagination",{attrs:{length:t.transactions.last_page,"total-visible":"5",circle:""},on:{input:function(e){return t.next_page(t.transactions.path,t.transactions.current_page)}},model:{value:t.transactions.current_page,callback:function(e){t.$set(t.transactions,"current_page",e)},expression:"transactions.current_page"}}):t._e()],1),t._v(" "),e("v-flex",{attrs:{sm12:""}},[e("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(a){var r=a.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:t.getTransactions},slot:"activator"},r),[e("v-icon",{attrs:{color:"blue darken-2",small:""}},[t._v("mdi-refresh")])],1)]}}],null,!1,3708677368)},[t._v(" "),e("span",[t._v("Refresh")])]),t._v(" "),e("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Quick Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),e("v-data-table",{staticClass:"elevation-1",staticStyle:{"font-size":"10px !important"},attrs:{headers:t.headers,items:t.transactions.data,search:t.search,"item-key":"id",loading:t.loading},scopedSlots:t._u([{key:"item.created_at",fn:function(a){var r=a.item;return[e("el-tag",{attrs:{type:"warning"}},[t._v(t._s(r.created_at))])]}},{key:"item.mpesa_code",fn:function(a){var r=a.item;return[e("el-tag",[t._v(t._s(r.mpesa_code))])]}},{key:"item.code_used",fn:function(t){var a=t.item;return[e("el-tooltip",{attrs:{content:a.code_used?"Code matched":"Code not matched",placement:"top"}},[e("v-avatar",{staticStyle:{cursor:"pointer"},attrs:{color:a.code_used?"green":"red",small:""}})],1)]}},t.user.can["Order view"]?{key:"item.actions",fn:function(a){var r=a.item;return[r.code_used?e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var n=a.on;return[e("v-btn",t._g({staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(e){return t.openShow(r.TransID)}},slot:"activator"},n),[e("v-icon",{attrs:{small:"",color:"blue darken-2"}},[t._v("mdi-eye-outline")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Quick view")])]):t._e()]}}:null],null,!0)})],1)],1):e("div",[e("mySetup")],1)],1):e("v-sheet",{staticClass:"px-3 pt-3 pb-3",staticStyle:{width:"100vw"},attrs:{color:"grey ".concat(t.theme.isDark?"darken-2":"lighten-4")}},[e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{"max-width":"900",type:"table"}})],1)],1),t._v(" "),e("myShow")],1)}),[],!1,null,null,null));e.default=d.exports},657:function(t,e,a){var r=a(857);"string"==typeof r&&(r=[[t.i,r,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};a(4)(r,n);r.locals&&(t.exports=r.locals)},856:function(t,e,a){"use strict";a(657)},857:function(t,e,a){(t.exports=a(3)(!1)).push([t.i,".el-input--prefix .el-input__inner{border-radius:50px!important}.v-toolbar__content,.v-toolbar__extension{height:auto!important}.v-avatar{height:10px!important;width:10px!important;margin-left:40%!important}.theme--light.v-data-table>.v-data-table__wrapper>table>tbody>tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper){cursor:pointer!important}#orders td{padding:0 0 0 15px!important}#orders .v-data-table>.v-data-table__wrapper>table{width:150%!important}#address_tab span{font-style:inherit;font-weight:inherit;white-space:nowrap;text-overflow:ellipsis;max-width:180px;overflow:hidden;display:block;-webkit-line-clamp:3;-webkit-box-orient:vertical}",""])}}]);